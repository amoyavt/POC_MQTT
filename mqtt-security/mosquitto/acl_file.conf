# MQTT ACL Configuration for F2 Controllers
# This file defines access control rules for authenticated devices
# Each device is identified by its MAC address (from client certificate CN)

# Global topics accessible to all authenticated devices
topic readwrite general
topic readwrite system/status
topic readwrite system/heartbeat

# Device-specific ACL entries will be added below during registration
# Format per device:
# user <MAC-ADDRESS>
# topic read    cmnd/f2-<MAC>/+/+/strike-+
# topic write   stat/f2-<MAC>/+/+/strike-+
# topic write   stat/f2-<MAC>/+/+/door-sensors
# topic read    cmnd/f2-<MAC>/+/+/reader-+/success
# topic write   tele/f2-<MAC>/+/+/reader-+
# topic write   stat/f2-<MAC>/+/+/exit-buttons
# topic read    cmnd/f2-<MAC>/+/+/siren-+
# topic write   stat/f2-<MAC>/+/+/siren-+
# topic write   stat/f2-<MAC>/+/+/motion-sensor-+
# topic write   tele/f2-<MAC>/+/+/sensor-+

# Example entry (will be auto-generated during device registration):
# user e4-fd-45-f6-54-be
# topic read    cmnd/f2-e4-fd-45-f6-54-be/+/+/strike-+
# topic write   stat/f2-e4-fd-45-f6-54-be/+/+/strike-+
# topic write   stat/f2-e4-fd-45-f6-54-be/+/+/door-sensors
# topic read    cmnd/f2-e4-fd-45-f6-54-be/+/+/reader-+/success
# topic write   tele/f2-e4-fd-45-f6-54-be/+/+/reader-+
# topic write   stat/f2-e4-fd-45-f6-54-be/+/+/exit-buttons
# topic read    cmnd/f2-e4-fd-45-f6-54-be/+/+/siren-+
# topic write   stat/f2-e4-fd-45-f6-54-be/+/+/siren-+
# topic write   stat/f2-e4-fd-45-f6-54-be/+/+/motion-sensor-+
# topic write   tele/f2-e4-fd-45-f6-54-be/+/+/sensor-+
# Device: e4-fd-45-f6-54-be (registered 2025-07-02 16:31:31)
user e4-fd-45-f6-54-be
topic readwrite general
topic readwrite system/status
topic readwrite system/heartbeat

# Electric Strike Control
topic read    cmnd/f2-e4-fd-45-f6-54-be/+/+/strike-+
topic write   stat/f2-e4-fd-45-f6-54-be/+/+/strike-+

# Door Sensors Status
topic write   stat/f2-e4-fd-45-f6-54-be/+/+/door-sensors

# QR/NFC Reader
topic read    cmnd/f2-e4-fd-45-f6-54-be/+/+/reader-+/success
topic write   tele/f2-e4-fd-45-f6-54-be/+/+/reader-+

# Exit Buttons
topic write   stat/f2-e4-fd-45-f6-54-be/+/+/exit-buttons

# Siren Control
topic read    cmnd/f2-e4-fd-45-f6-54-be/+/+/siren-+
topic write   stat/f2-e4-fd-45-f6-54-be/+/+/siren-+

# Motion Sensors
topic write   stat/f2-e4-fd-45-f6-54-be/+/+/motion-sensor-+

# RS-485 Sensors
topic write   tele/f2-e4-fd-45-f6-54-be/+/+/sensor-+


# Device: a1-b2-c3-d4-e5-f6 (registered 2025-07-02 16:31:52)
user a1-b2-c3-d4-e5-f6
topic readwrite general
topic readwrite system/status
topic readwrite system/heartbeat

# Electric Strike Control
topic read    cmnd/f2-a1-b2-c3-d4-e5-f6/+/+/strike-+
topic write   stat/f2-a1-b2-c3-d4-e5-f6/+/+/strike-+

# Door Sensors Status
topic write   stat/f2-a1-b2-c3-d4-e5-f6/+/+/door-sensors

# QR/NFC Reader
topic read    cmnd/f2-a1-b2-c3-d4-e5-f6/+/+/reader-+/success
topic write   tele/f2-a1-b2-c3-d4-e5-f6/+/+/reader-+

# Exit Buttons
topic write   stat/f2-a1-b2-c3-d4-e5-f6/+/+/exit-buttons

# Siren Control
topic read    cmnd/f2-a1-b2-c3-d4-e5-f6/+/+/siren-+
topic write   stat/f2-a1-b2-c3-d4-e5-f6/+/+/siren-+

# Motion Sensors
topic write   stat/f2-a1-b2-c3-d4-e5-f6/+/+/motion-sensor-+

# RS-485 Sensors
topic write   tele/f2-a1-b2-c3-d4-e5-f6/+/+/sensor-+

